function formatPRComment(analysis, prData) {
  const score = analysis.healthScore ?? 0;

  const healthEmoji = score >= 80 ? "ğŸŸ¢" : score >= 50 ? "ğŸŸ¡" : "ğŸ”´";

  const severityBadge = {
    error: "ğŸ”´ **ERROR**",
    warning: "ğŸŸ  **WARNING**",
    info: "ğŸ”µ **INFO**",
  };

  return `
## ğŸ¤– **MergeMind PR Analysis**

> _Automated AI-powered pull request review_

---

### ğŸ©º **Overall Health**
${healthEmoji} **Score:** **${score}/100**

---

### ğŸ“ **Summary**
${analysis.summary || "_No summary provided._"}

---

### ğŸ“Š **PR Statistics**

| Metric | Value |
|------|------|
| ğŸ“ Files Changed | ${prData.changedFiles} |
| â• Lines Added | ${prData.additions} |
| â– Lines Deleted | ${prData.deletions} |
| ğŸ”€ Commits | ${prData.commits} |

---

<details>
<summary><strong>ğŸ” Key Findings</strong></summary>

<br/>

${
  analysis.keyFindings?.length
    ? analysis.keyFindings.map((k) => `- ${k}`).join("\n")
    : "- âœ… No major issues detected"
}

</details>

---

<details>
<summary><strong>ğŸ›  Suggestions & Improvements</strong></summary>

<br/>

${
  analysis.suggestions?.length
    ? analysis.suggestions
        .map(
          (s, i) => `
### ${severityBadge[s.severity] || "â„¹ï¸ **INFO**"} â€” Issue ${i + 1}

- **ğŸ“„ File:** \`${s.file || "N/A"}\`
- **â— Issue:** ${s.description}
- **ğŸ’¡ Suggested Fix:**
\`\`\`
${s.suggestedFix}
\`\`\`
`
        )
        .join("\n")
    : "âœ… **No suggestions â€” PR looks solid!**"
}

</details>

---

### ğŸ§  **MergeMind AI Verdict**
${
  score >= 80
    ? "âœ… This PR is **healthy** and follows best practices."
    : score >= 50
    ? "âš ï¸ This PR is **acceptable**, but improvements are recommended."
    : "âŒ This PR needs **attention before merging**."
}

<sub>ğŸ§  Generated by <strong>MergeMind AI</strong> Â· Continuous PR Intelligence</sub>
`;
}

module.exports = {
  formatPRComment,
};
